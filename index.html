<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›¾ç‰‡è½¬æ–‡å­— - OCRå·¥å…·</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“· å›¾ç‰‡è½¬æ–‡å­—å·¥å…·</h1>
            <p>ä¸Šä¼ å›¾ç‰‡ï¼Œè‡ªåŠ¨è¯†åˆ«å…¶ä¸­çš„æ–‡å­—å†…å®¹</p>
        </header>

        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ“¤</div>
                <p class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°è¿™é‡Œ</p>
                <p class="upload-hint">æ”¯æŒ JPGã€PNGã€GIF ç­‰æ ¼å¼</p>
                <input type="file" id="fileInput" accept="image/*" hidden>
            </div>
        </div>

        <div class="preview-section" id="previewSection" style="display: none;">
            <div class="image-preview">
                <h3>å›¾ç‰‡é¢„è§ˆ</h3>
                <img id="previewImage" alt="é¢„è§ˆå›¾ç‰‡">
            </div>
        </div>

        <div class="control-section" id="controlSection" style="display: none;">
            <button id="recognizeBtn" class="btn btn-primary">
                <span class="btn-text">å¼€å§‹è¯†åˆ«</span>
                <span class="btn-loading" style="display: none;">è¯†åˆ«ä¸­...</span>
            </button>
            <button id="clearBtn" class="btn btn-secondary">æ¸…é™¤</button>
        </div>

        <div class="progress-section" id="progressSection" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <p class="progress-text" id="progressText">å‡†å¤‡ä¸­...</p>
        </div>

        <div class="result-section" id="resultSection" style="display: none;">
            <h3>è¯†åˆ«ç»“æœ</h3>
            <div class="result-content">
                <textarea id="resultText" readonly></textarea>
                <button id="copyBtn" class="btn btn-copy">ğŸ“‹ å¤åˆ¶æ–‡å­—</button>
            </div>
        </div>
    </div>

    <!-- ä¸» CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.1.1/dist/tesseract.min.js" 
            onerror="loadTesseractFallback()"></script>
    <script>
        // å¤‡ç”¨ CDN åŠ è½½å‡½æ•°
        function loadTesseractFallback() {
            console.warn('ä¸» CDN åŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨ CDN...');
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/tesseract.js@4.1.1/dist/tesseract.min.js';
            script.onerror = function() {
                console.error('æ‰€æœ‰ CDN åŠ è½½å¤±è´¥');
                alert('OCR åº“åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ååˆ·æ–°é¡µé¢é‡è¯•ã€‚\n\nå¦‚æœé—®é¢˜æŒç»­ï¼Œå¯èƒ½æ˜¯ç½‘ç»œæˆ– CDN è®¿é—®é—®é¢˜ã€‚');
            };
            script.onload = function() {
                console.log('å¤‡ç”¨ CDN åŠ è½½æˆåŠŸ');
                // é‡æ–°åˆå§‹åŒ–è„šæœ¬
                if (typeof initApp === 'function') {
                    initApp();
                }
            };
            document.head.appendChild(script);
        }
        
        // æ£€æŸ¥ Tesseract.js æ˜¯å¦åŠ è½½æˆåŠŸ
        window.addEventListener('load', function() {
            setTimeout(function() {
                if (typeof Tesseract === 'undefined') {
                    console.error('Tesseract.js åŠ è½½å¤±è´¥');
                    // å°è¯•åŠ è½½å¤‡ç”¨ CDN
                    loadTesseractFallback();
                } else {
                    console.log('Tesseract.js åŠ è½½æˆåŠŸ');
                    if (Tesseract.version) {
                        console.log('ç‰ˆæœ¬:', Tesseract.version);
                    }
                }
            }, 1000); // ç­‰å¾… 1 ç§’ç¡®ä¿è„šæœ¬åŠ è½½å®Œæˆ
        });
    </script>
    <script src="script.js"></script>
</body>
</html>

